# GoBarcodeService
Универсальный HTTP сервис для генерации штрих-кодов и QR-кодов. Легко интегрируется в веб-приложения, 1С и другие системы. Поддерживает EAN13, EAN128, QR, DataMatrix. Поддерживает форматы:

- **QR**
- **DataMatrix**
- **EAN-13**
- **EAN-128 (Code 128)**

Сервис возвращает изображение в формате PNG.

---

## Установка и запуск

### Требования
- Go 1.21+
- Git

### Сборка и запуск
```bash
git clone https://github.com/Impuls2003/GoBarcodeService.git
cd GoBarcodeService
go mod init GoBarcodeService
go get golang.org/x/image/font
go get github.com/boombuler/barcode
go get github.com/kardianos/service
go build -o GoBarcodeService.exe
./GoBarcodeService.exe
```
По умолчанию сервис запускается на порту __8080__.

## Использование ##
### Доступные эндпоинты ###
- **/qr?text=Hello** — QR-код
- **/datamatrix?text=Hello** — DataMatrix
- **/ean13?text=123456789012** — EAN-13 (12 цифр, 13-я контрольная вычисляется автоматически)
- **/ean128?text=Hello** — EAN-128 / Code128

### Поддерживаемые параметры ###
- text — содержимое кода (обязательный)
- level — уровень коррекции QR (1–4, по умолчанию 2)
- width — ширина изображения в пикселях (по умолчанию 256)
- height — высота изображения в пикселях (по умолчанию 128, используется только для линейных штрих-кодов)

### Примеры запросов ###
1. Через браузер (**GET**)
- http://127.0.0.1:8080/qr?text=Hello&width=256&level=3 — сформирует QR код размером 256х256 пикселей с текстом Hello
- http://127.0.0.1:8080/datamatrix?text=Hello — сформирует Datamatrix код размером 256х256 пикселей с текстом Hello
2. Через curl (**POST**)
  ```bash
  curl -X POST -d "text=HelloWorld" -d "width=300" http://localhost:8080/ean128 --output code.png
  ```
3. В **1С**
```1C
  Функция ВыполнитьЗапрос(Адрес, ТекстДляЗапроса, Параметры)
	Тело = "";
    Для Каждого парам Из Параметры Цикл
        Если Тело <> "" Тогда
            Тело = Тело + "&";
        КонецЕсли;
        Тело = Тело + парам.Ключ + "=" + КодироватьСтроку(парам.Значение, СпособКодированияСтроки.КодировкаURL);
	КонецЦикла;
	
	Соединение 	= Новый HTTPСоединение(Адрес, 8080);
	Запрос 		= Новый HTTPЗапрос(ТекстДляЗапроса+"?"+Тело);		
	Ответ 		= Соединение.Получить(Запрос);    	
	
	ДД			= Ответ.ПолучитьТелоКакДвоичныеДанные();	
	Рез = новый Структура("ДД, ТекстОтвета, Заголовки, КодСостояния", ДД, "", Ответ.Заголовки, Ответ.КодСостояния);
	Если (Ответ.КодСостояния <> 200) Тогда
		Рез.ТекстОтвета = Ответ.ПолучитьТелоКакСтроку(); 
	КонецЕсли;

	Возврат Рез;
КонецФункции

// Вызов
Парам = новый Структура();
Парам.Вставить("text", "HelloWorld");
Парам.Вставить("width", 200);
Ответ = ВыполнитьЗапрос("127.0.0.1", "qr", Парам); 
Если (Ответ.КодСостояния = 200) Тогда
  Картинка = новый Картинка(Ответ.ДД);
Иначе
  Сообщить(Ответ.ТекстОтвета);
КонецЕсли;
```
## Управление как службой ##
Приложение использует библиотеку [kardianos/service](https://github.com/kardianos/service), поэтому его можно зарегистрировать как системный сервис:
 ```bash
./GoBarcodeService install   # установить сервис
./GoBarcodeService start     # запустить
./GoBarcodeService stop      # остановить
./GoBarcodeService uninstall # удалить
  ```
